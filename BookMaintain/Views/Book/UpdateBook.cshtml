
<h2 style="margin-top:80px;margin-left:44.5%;font-weight:bold;">修改書籍</h2>

<form id="UpdateForm">
    <div class="form-horizontal">
        <hr />
        <span id="notification"></span>

        <div class="form-group" style="margin-left:23%;">
            <label class="control-label col-md-2 required">書籍名稱</label>
            <div class="col-md-10">
                <input class="form-control input-width" id="BookName" name="BookName" type="text" required validationMessage="請輸入書籍名稱" />
            </div>
        </div>

        <div class="form-group" style="margin-left:23%;">
            <label class="control-label col-md-2 required">作者</label>
            <div class="col-md-10">
                <input class="form-control input-width" id="BookAuthor" name="BookAuthor" type="text" required validationMessage="請輸入作者" />
            </div>
        </div>

        <div class="form-group" style="margin-left:23%;">
            <label class="control-label col-md-2 required">出版商</label>
            <div class="col-md-10">
                <input class="form-control input-width" id="BookPublisher" name="BookPublisher" type="text" required validationMessage="請輸入出版商" />
            </div>
        </div>

        <div class="form-group" style="margin-left:23%;">
            <label class="control-label col-md-2 required">購買日期</label>
            <div class="col-md-10">
                <input class="form-control input-width" id="BookBoughtDate" name="BookBoughtDate" type="text" required validationMessage="請輸入購買日期" />
            </div>
        </div>

        <div class="form-group" style="margin-left:23%;">
            <label class="control-label col-md-2 required">內容簡介</label>
            <div class="col-md-10">
                <textarea class="form-control input-width" id="BookNote" name="BookNote" required validationMessage="請輸入內容簡介"></textarea>
            </div>
        </div>

        <div class="form-group" style="margin-left:23%;">
            <label class="control-label col-md-2 required">書籍類別</label>
            <div class="col-md-10">
                <input class="form-control input-width" id="BookClassId" required validationMessage="請輸入書籍類別" />
            </div>
        </div>

        <div class="form-group" style="margin-left:23%;">
            <label class="control-label col-md-2 required">借閱狀態</label>
            <div class="col-md-10">
                <input class="form-control input-width" id="BookStatusId" required validationMessage="請輸入借閱狀態" />
            </div>
        </div>

        <div class="form-group" style="margin-left:23%;">
            <label class="control-label col-md-2">借閱人</label>
            <div class="col-md-10">
                <input class="form-control input-width" id="BookKeeperId" />
            </div>
        </div>
    </div>
</form>

<div class="form-group" style="margin-left:23%;">
    <div class="col-md-offset-2 col-md-10" style="margin-left:35%">
        <button class="btn btn-default" id="SaveUpdate">存檔</button>
        <button class="btn btn-default" id="DeleteBook">刪除</button>
    </div>
</div>

<div id="make_sure_window" style="display: none">
    <p style="text-align:center;">確定要刪除嗎？</p>
    <div style="margin-left:9%;">
        <button id="DeleteinUpdateYES">確定</button>
        <button id="NO">取消</button>
    </div>
</div>

<script src="~/Scripts/script.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $.ajax({
            url: "/Book/DetailBook",
            type: "post",
            data: { BookId: GetId() },
            dataType: "json",
            success: function (Book) {
                $("#BookName").val(Book.BookName);
                $("#BookAuthor").val(Book.BookAuthor);
                $("#BookPublisher").val(Book.BookPublisher);
                $("#BookBoughtDate").data("kendoDatePicker").value(Book.BookBoughtDate);
                $("#BookNote").val(Book.BookNote);
                $("#BookClassId").data("kendoDropDownList").value(Book.BookClassId);
                $("#BookKeeperId").data("kendoDropDownList").value(Book.BookKeeperId);
                $("#BookStatusId").data("kendoDropDownList").value(Book.BookStatusId);

                var Bookstatus = $("#BookStatusId").data("kendoDropDownList").value();
                if (Bookstatus == "A" || Bookstatus == "U") {
                    $("#BookKeeperId").data("kendoDropDownList").readonly();
                }
            },
            error: function () {
                $("#notification").data("kendoNotification").show("系統發生錯誤", "error");
            }
        });

        $("#BookStatusId").data("kendoDropDownList").bind("change", ChangeStatus);
        function ChangeStatus() {
            var status = $("#BookStatusId").data("kendoDropDownList").value();
            //A-可以借閱 U-不可借閱 清空借閱人 唯讀
            if (status == "A" || status == "U") {
                $("#BookKeeperId").data("kendoDropDownList").select(0);
                $("#BookKeeperId").data("kendoDropDownList").readonly();
            }
            //B-已借閱 C-已借未領 借閱人可選
            else if (status == "B" || status == "C") {
                $("#BookKeeperId").data("kendoDropDownList").readonly(false);
            }
        }
    });
</script>
